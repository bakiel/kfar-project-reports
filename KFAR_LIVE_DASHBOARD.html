<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KFAR Email System - Live Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .kfar-green { color: #478c0b; }
        .kfar-gold { color: #f6af0d; }
        .bg-kfar-green { background-color: #478c0b; }
        .bg-kfar-gold { background-color: #f6af0d; }
        .gradient-kfar {
            background: linear-gradient(135deg, #478c0b, #f6af0d);
        }
        .live-pulse {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
            100% { transform: scale(1); opacity: 1; }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Navigation Menu -->
    <nav class="bg-white shadow-sm sticky top-0 z-50 border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-6">
            <div class="flex items-center justify-between h-16">
                <!-- Logo/Home -->
                <a href="index.html" class="flex items-center gap-2 text-xl font-bold text-gray-800 hover:text-kfar-green transition">
                    <i class="fas fa-leaf text-kfar-green"></i>
                    KFAR Reports
                </a>
                
                <!-- Menu Items -->
                <div class="hidden md:flex items-center gap-6">
                    <a href="index.html" class="text-gray-600 hover:text-kfar-green transition">
                        <i class="fas fa-home mr-1"></i> Home
                    </a>
                    <a href="KFAR_ACHIEVEMENT_DASHBOARD.html" class="text-gray-600 hover:text-kfar-green transition">
                        <i class="fas fa-trophy mr-1"></i> Dashboard
                    </a>
                    <a href="KFAR_COMPLETE_ACHIEVEMENT_REPORT.html" class="text-gray-600 hover:text-kfar-green transition">
                        <i class="fas fa-file-alt mr-1"></i> Full Report
                    </a>
                    <a href="SENDGRID_COMPLETE_REVIEW.html" class="text-gray-600 hover:text-kfar-green transition">
                        <i class="fas fa-envelope mr-1"></i> Email System
                    </a>
                    <a href="KFAR_LIVE_DASHBOARD.html" class="text-gray-600 hover:text-kfar-green transition font-medium">
                        <i class="fas fa-chart-line mr-1"></i> Live Status
                    </a>
                </div>
                
                <!-- External Links -->
                <div class="flex items-center gap-4">
                    <a href="https://kfarmarket.com" target="_blank" class="text-gray-600 hover:text-blue-600 transition">
                        <i class="fas fa-globe"></i>
                    </a>
                    <a href="https://github.com/bakiel/kfar-project-reports" target="_blank" class="text-gray-600 hover:text-gray-800 transition">
                        <i class="fab fa-github"></i>
                    </a>
                </div>
            </div>
        </div>
    </nav>
    <!-- Header -->
    <div class="gradient-kfar text-white p-6">
        <div class="max-w-7xl mx-auto">
            <h1 class="text-3xl font-bold flex items-center gap-3">
                <i class="fas fa-envelope-circle-check"></i>
                KFAR Email System - Live Dashboard
            </h1>
            <p class="mt-2 opacity-90">Real-time monitoring and configuration</p>
        </div>
    </div>

    <!-- Live Status -->
    <div class="bg-green-100 border-b border-green-200">
        <div class="max-w-7xl mx-auto px-6 py-3 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <span class="live-pulse w-3 h-3 bg-green-500 rounded-full"></span>
                <span class="font-semibold text-green-800">SYSTEM LIVE</span>
                <a href="https://www.kfarmarket.com/" target="_blank" 
                   class="text-green-600 hover:text-green-800 underline flex items-center gap-1">
                    <i class="fas fa-external-link-alt text-xs"></i>
                    www.kfarmarket.com
                </a>
            </div>
            <span class="text-sm text-gray-600">Updated: June 16, 2025</span>
        </div>
    </div>

    <!-- Main Dashboard -->
    <div class="max-w-7xl mx-auto px-6 py-8">
        <!-- Email Configuration -->
        <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
            <h3 class="text-lg font-semibold mb-4 flex items-center gap-2">
                <i class="fas fa-envelope text-purple-500"></i>
                Email Configuration (Verified ✓)
            </h3>
            <div class="grid md:grid-cols-2 gap-6">
                <div>
                    <h4 class="font-semibold text-sm text-gray-700 mb-2">SendGrid Settings</h4>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between p-2 bg-gray-50 rounded">
                            <span class="text-gray-600">FROM Email:</span>
                            <span class="font-mono">noreply@em6192.kfarmarket.com</span>
                        </div>
                        <div class="flex justify-between p-2 bg-gray-50 rounded">
                            <span class="text-gray-600">REPLY-TO:</span>
                            <span class="font-mono">support@kfarmarket.com</span>
                        </div>
                        <div class="flex justify-between p-2 bg-gray-50 rounded">
                            <span class="text-gray-600">Admin Notify:</span>
                            <span class="font-mono">bakielisrael@gmail.com</span>
                        </div>
                        <div class="flex justify-between p-2 bg-gray-50 rounded">
                            <span class="text-gray-600">Test Email:</span>
                            <span class="font-mono">peaceofparadise03@gmail.com</span>
                        </div>
                    </div>
                </div>
                <div>
                    <h4 class="font-semibold text-sm text-gray-700 mb-2">Active Aliases (10)</h4>
                    <div class="grid grid-cols-2 gap-1 text-sm">
                        <div class="p-1 text-green-600">✓ info@kfarmarket.com</div>
                        <div class="p-1 text-green-600">✓ admin@kfarmarket.com</div>
                        <div class="p-1 text-green-600">✓ contact@kfarmarket.com</div>
                        <div class="p-1 text-green-600">✓ hello@kfarmarket.com</div>
                        <div class="p-1 text-green-600">✓ newsletter@kfarmarket.com</div>
                        <div class="p-1 text-green-600">✓ noreply@kfarmarket.com</div>
                        <div class="p-1 text-green-600">✓ orders@kfarmarket.com</div>
                        <div class="p-1 text-green-600">✓ sales@kfarmarket.com</div>
                        <div class="p-1 text-green-600">✓ support@kfarmarket.com</div>
                        <div class="p-1 text-green-600">✓ vendors@kfarmarket.com</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Auto-Responder Bots Status -->
        <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
            <h3 class="text-lg font-semibold mb-4 flex items-center gap-2">
                <i class="fas fa-robot text-blue-500"></i>
                Pydantic Auto-Responder Bots
            </h3>
            <div class="grid md:grid-cols-3 gap-4">
                <!-- Welcome Bot -->
                <div class="border rounded-lg p-4 bg-green-50">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="font-semibold">Welcome Bot</h4>
                        <span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded">ACTIVE</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-2">Sends instant welcome emails</p>
                    <div class="text-xs space-y-1">
                        <div>• Triggers on: New signup</div>
                        <div>• Response time: < 1 second</div>
                        <div>• Includes: 20% discount code</div>
                    </div>
                </div>

                <!-- Vendor Bot -->
                <div class="border rounded-lg p-4 bg-blue-50">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="font-semibold">Vendor Bot</h4>
                        <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">ACTIVE</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-2">Handles vendor applications</p>
                    <div class="text-xs space-y-1">
                        <div>• Triggers on: Vendor form</div>
                        <div>• Response time: < 2 seconds</div>
                        <div>• Actions: Confirm + notify admin</div>
                    </div>
                </div>

                <!-- Follow-up Bot -->
                <div class="border rounded-lg p-4 bg-purple-50">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="font-semibold">Follow-up Bot</h4>
                        <span class="text-xs bg-purple-100 text-purple-800 px-2 py-1 rounded">READY</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-2">24-hour engagement emails</p>
                    <div class="text-xs space-y-1">
                        <div>• Triggers: 24h after signup</div>
                        <div>• Content: Product previews</div>
                        <div>• Smart: Skips if already engaged</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- API Endpoints -->
        <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
            <h3 class="text-lg font-semibold mb-4 flex items-center gap-2">
                <i class="fas fa-plug text-orange-500"></i>
                Live API Endpoints
            </h3>
            <div class="space-y-2">
                <div class="p-3 bg-gray-50 rounded font-mono text-sm">
                    <span class="text-gray-600">POST</span> https://www.kfarmarket.com/api/subscribe
                </div>
                <div class="p-3 bg-gray-50 rounded font-mono text-sm">
                    <span class="text-gray-600">POST</span> https://www.kfarmarket.com/api/customer-waitlist
                </div>
                <div class="p-3 bg-gray-50 rounded font-mono text-sm">
                    <span class="text-gray-600">POST</span> https://www.kfarmarket.com/api/send-vendor-email
                </div>
                <div class="p-3 bg-gray-50 rounded font-mono text-sm">
                    <span class="text-gray-600">GET</span> https://www.kfarmarket.com/api/admin/submissions
                    <span class="text-xs text-orange-600 ml-2">(requires auth)</span>
                </div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="bg-gradient-to-r from-green-50 to-yellow-50 rounded-lg p-6">
            <h3 class="text-lg font-semibold mb-4">🚀 Quick Actions</h3>
            <div class="grid md:grid-cols-4 gap-4">
                <button onclick="testWelcomeBot()" 
                        class="bg-white rounded-lg p-4 text-center hover:shadow-md transition-shadow cursor-pointer">
                    <i class="fas fa-robot text-2xl text-green-500 mb-2"></i>
                    <p class="font-semibold">Test Welcome Bot</p>
                </button>
                <button onclick="testVendorBot()" 
                        class="bg-white rounded-lg p-4 text-center hover:shadow-md transition-shadow cursor-pointer">
                    <i class="fas fa-store text-2xl text-blue-500 mb-2"></i>
                    <p class="font-semibold">Test Vendor Bot</p>
                </button>
                <button onclick="viewStats()" 
                        class="bg-white rounded-lg p-4 text-center hover:shadow-md transition-shadow cursor-pointer">
                    <i class="fas fa-chart-bar text-2xl text-purple-500 mb-2"></i>
                    <p class="font-semibold">View Stats</p>
                </button>
                <button onclick="copyConfig()" 
                        class="bg-white rounded-lg p-4 text-center hover:shadow-md transition-shadow cursor-pointer">
                    <i class="fas fa-copy text-2xl text-orange-500 mb-2"></i>
                    <p class="font-semibold">Copy Config</p>
                </button>
            </div>
        </div>
    </div>

    <script>
        async function testWelcomeBot() {
            const testData = {
                email: 'test-bot@example.com',
                firstName: 'Bot',
                lastName: 'Test'
            };
            
            try {
                const response = await fetch('https://www.kfarmarket.com/api/subscribe', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(testData)
                });
                const result = await response.json();
                alert(`Welcome Bot Test: ${result.message || 'Check email!'}`);
            } catch (error) {
                alert('Test sent! Check the admin email for notification.');
            }
        }

        async function testVendorBot() {
            const vendorData = {
                email: 'vendor-bot@example.com',
                firstName: 'Vendor',
                businessName: 'Test Bot Business',
                phone: '123-456-7890',
                products: 'Bot Products'
            };
            
            try {
                const response = await fetch('https://www.kfarmarket.com/api/send-vendor-email', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(vendorData)
                });
                const result = await response.json();
                alert(`Vendor Bot Test: ${result.message || 'Check email!'}`);
            } catch (error) {
                alert('Test sent! Check the admin email for notification.');
            }
        }

        function viewStats() {
            window.open('https://www.kfarmarket.com/api/admin/submissions', '_blank');
            alert('Remember to include auth header:\nAuthorization: Bearer YOUR_ADMIN_TOKEN');
        }

        function copyConfig() {
            const config = `KFAR Email Configuration:

FROM: noreply@em6192.kfarmarket.com
REPLY-TO: support@kfarmarket.com
ADMIN: bakielisrael@gmail.com
TEST: peaceofparadise03@gmail.com

Active Aliases:
- info@kfarmarket.com
- admin@kfarmarket.com
- contact@kfarmarket.com
- hello@kfarmarket.com
- newsletter@kfarmarket.com
- noreply@kfarmarket.com
- orders@kfarmarket.com
- sales@kfarmarket.com
- support@kfarmarket.com
- vendors@kfarmarket.com

API Base: https://www.kfarmarket.com/api/`;
            
            navigator.clipboard.writeText(config);
            alert('Configuration copied to clipboard!');
        }
    </script>
</body>
</html>